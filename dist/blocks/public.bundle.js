(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function r(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0!==a){var i=a.call(t,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(r)?r:String(r)}var i=["id","referral_link","x_message","email_message","email_template_id","ui_type","email_success_message","email_success_btn_label"],n=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"initBswpDynamicTemplateVars",(function(){t.bswpFixedDinamicTemplVars=["bswp_greeting","bswp_referral_link","bswp_email_message","bswp_sender_first_name","bswp_x_message","bswp_email_success_message","bswp_email_success_btn_label"],t.parserRules={bswp_greeting:{id:"bswp_greeting",pattern:/<span class=('|")bswp-contact-name('|")>(.*?)<\/span>/g,valueStr:'<span class="bswp-contact-name">(.*?)</span>'},bswp_referral_link:{id:"bswp_referral_link",pattern:/<a href=('|")(.*?)('|") target=('|")_blank('|") class=('|")bswp-email-preview-ref-link('|")>(.*?)<\/a>/g,valueStr:'<a href="(.*?)" target="_blank" class="bswp-email-preview-ref-link">(.*?)</a>'},bswp_email_message:{id:"bswp_email_message",pattern:/<span class=('|")bswp-email-message-wrapper('|")>(.*?)<\/span>/g,valueStr:'<span class="bswp-email-message-wrapper">(.*?)</span>'},bswp_sender_first_name:{id:"bswp_sender_first_name",pattern:/<span class=('|")bswp-sender-name('|")>(.*?)<\/span>/g,valueStr:'<span class="bswp-sender-name">(.*?)</span>'},bswp_email_success_message:{id:"bswp_email_success_message",pattern:/<div class=('|")bswp-success-message-hidden('|")>(.*?)<\/div>/g,valueStr:'<div class="bswp-success-message-hidden">(.*?)</div>'},bswp_email_success_btn_label:{id:"bswp_email_success_btn_label",pattern:/<span class=('|")bswp-success-cta-label('|")>(.*?)<\/span>/g,valueStr:'<span class="bswp-success-cta-label">(.*?)</span>'}},t.bswpDynamicTemplVars=[],t.bswpDynamicTemplVarsData=[],t.bswpCustomDynamicTemplVars=[],t.setDynamicTemplVars()})),r(this,"initLoggedinUser",(function(){t.loggedinUser.first_name="",t.loggedinUser.last_name="",t.loggedinUser.email="",document.querySelector(".bswp-user-first-name")&&(t.loggedinUser.first_name=document.querySelector(".bswp-user-first-name").value.trim()),document.querySelector(".bswp-user-last-name")&&(t.loggedinUser.last_name=document.querySelector(".bswp-user-last-name").value.trim()),document.querySelector(".bswp-user-email")&&(t.loggedinUser.email=document.querySelector(".bswp-user-email").value.trim())})),r(this,"initEmailPreviewShadowDOM",(function(){var e=document.querySelectorAll(".bswp-email-preview-container");e.length&&e.forEach((function(e){var r=e.closest(".wp-block-cgb-block-ea-better-sharing"),a=JSON.parse(r.dataset.blockAttr),i=JSON.parse(e.dataset.emailPreview),n=e.attachShadow({mode:"open"}),s=t.createShadowStyle(".bswp-email-preview-label {\n          margin: 1rem 0 0.5rem 0;\n        }\n        .bswp-email-preview {\n          background-color: #f1f2f3;\n          padding: 1rem;\n        }");n.appendChild(s);var l=t.createHtmlElement("p",["bswp-email-preview-label"],null,translations.emailSubjectPreview),o=t.parseContent(i.email_subject,a),c=t.createHtmlElement("div",["bswp-email-preview"],"",o),m=t.createHtmlElement("p",["bswp-email-preview-label"],null,translations.emailMessagePreview),u=t.parseContent(i.email_body,a),p=t.createHtmlElement("div",["bswp-email-preview"],"",u);n.appendChild(l),n.appendChild(c),n.appendChild(m),n.appendChild(p)}))})),r(this,"updatePreviewContent",(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=e.querySelector(".bswp-email-preview-container");if(i)switch(r){case"greeting":var n=i.shadowRoot.querySelectorAll(".bswp-contact-name");n.length&&n.forEach((function(e){return e.innerText=a}));break;case"message":var s=i.shadowRoot.querySelectorAll(".custom-message-wrapper");s.length&&s.forEach((function(e){return e.innerText=a}));break;case"sender":var l=i.shadowRoot.querySelectorAll(".bswp-sender-name");l.length&&l.forEach((function(e){return e.innerText=a}));break;default:var o=i.shadowRoot.querySelectorAll(".bswp-contact-name");if(o.length){var c=t.bswpDynamicTemplVars.find((function(e){return"bswp_greeting"===e.id}));o.forEach((function(e){return e.innerText=c?c.base:"there"}))}var m=i.shadowRoot.querySelectorAll(".custom-message-wrapper");m.length&&m.forEach((function(e){return e.innerText=""}));var u=i.shadowRoot.querySelectorAll(".bswp-sender-name");if(u.length){var p="your friend",b=document.querySelector(".bswp-user-first-name");if(b){var f=b.value;f.trim()&&(p=f)}var d=t.bswpDynamicTemplVars.find((function(e){return"bswp_sender_first_name"===e.id}));d&&(p=d.base),u.forEach((function(e){return e.innerText=p}))}}})),r(this,"validateEmailForm",(function(e){var r=e.querySelector(".bswp-share-email-content"),a=e.querySelector(".bswp-share-email-input"),i=e.querySelector("#coreblock-email-sent-msg");return a.value.trim()?t.validateEmails(a.value.trim())?r&&!r.value.trim()?(t.messageDisplay(translations.messageIsRequired,"coreblock-error-msg",i),!1):!!t.validateEmailLimit(a.value)||(t.messageDisplay(translations.emailsExceedLimit,"coreblock-error-msg",i),!1):(t.messageDisplay(translations.enterOnlyValidEmails,"coreblock-error-msg",i),!1):(t.messageDisplay(translations.noEmailsFound,"coreblock-error-msg",i),!1)})),r(this,"handleEmails",(function(e){var r=[];return t.convertEmailsInputToArray(e).forEach((function(e){var a=t.emailData.find((function(t){return t.recipient_email===e}));a?r.push(a):r.push({recipient_email:e,recipient_first_name:"",recipient_last_name:""})})),r})),r(this,"validateEmails",(function(e){var r=t.convertEmailsInputToArray(e),a=!0,i=/.+@.+\..+/;return r.every((function(e){return!!e.match(i)||(a=!1,!1)})),a})),r(this,"messageDisplay",(function(e,t,r){r.setAttribute("class",""),r.innerText=e,r.style.display="inline-block",r.classList.add(t),setTimeout((function(){r.innerText="",r.style.display="none",r.classList.remove(t)}),3e3)})),r(this,"validateEmailLimit",(function(e){var r=t.convertEmailsInputToArray(e);return!(t.emailsLimit&&r.length>t.emailsLimit)})),r(this,"convertEmailsInputToArray",(function(e){var t=e.split(",").map((function(e){return e.trim()}));return t.reduce((function(e,t){return-1==e.indexOf(t)&&""!==t&&e.push(t),e}),[])})),r(this,"previewCustomMessage",(function(e){var t=e.target.value,r=e.target.closest(".email").querySelector(".bswp-email-preview-container");r&&r.shadowRoot.querySelectorAll(".custom-message-wrapper").forEach((function(e){return e.innerText=t}))})),r(this,"setDynamicTemplVars",(function(){var e=document.getElementsByTagName("meta");if(e.length)for(var r=0;r<e.length;r++)String(e[r].getAttribute("itemprop")).includes("bswp_")&&(t.bswpFixedDinamicTemplVars.includes(e[r].getAttribute("itemprop"))?t.pushDynamicTemplVar(e[r]):t.pushCustomDynamicTemplVar(e[r]))})),r(this,"pushDynamicTemplVar",(function(e){if(t.parserRules[e.getAttribute("itemprop")]){var r=t.parserRules[e.getAttribute("itemprop")];r.value=r.valueStr.replaceAll("(.*?)",e.getAttribute("content")),r.base=e.getAttribute("content"),t.bswpDynamicTemplVars.push(r),t.parserRules[e.getAttribute("itemprop")]&&t.bswpDynamicTemplVarsData.push({id:e.getAttribute("itemprop"),replace:e.getAttribute("content")})}})),r(this,"pushCustomDynamicTemplVar",(function(e){var r=e.getAttribute("itemprop").trim().replace("bswp_",""),a=e.getAttribute("content").trim();t.bswpCustomDynamicTemplVars.push({id:r,replace:a})})),r(this,"parseContent",(function(e,r){return t.bswpDynamicTemplVars.length&&(e=t.parseDynamicTemplateVars(e,"fixed",r)),t.bswpCustomDynamicTemplVars.length&&(e=t.parseDynamicTemplateVars(e,"custom",r)),e})),r(this,"parseDynamicTemplateVars",(function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(r){case"fixed":for(var i in t.bswpDynamicTemplVars){var n=t.bswpDynamicTemplVars[i].id.replace("bswp_","");a[n]||"bswp_sender_first_name"===t.bswpDynamicTemplVars[i].id&&t.loggedinUser.first_name||(e=e.replace(t.bswpDynamicTemplVars[i].pattern,t.bswpDynamicTemplVars[i].value))}return e;case"custom":return t.bswpCustomDynamicTemplVars.forEach((function(t){var r=t.id,i=new RegExp("{{\\s?".concat(t.id,"\\s?}}"),"g");e=a[r]?e.replaceAll(i,a[r]):e.replaceAll(i,t.replace)})),e;default:return e}})),r(this,"createShadowStyle",(function(e){var t=document.createElement("style");return t.textContent=e,t})),r(this,"createHtmlElement",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=document.createElement(e);return r&&i.setAttribute("id",r),t.length&&t.forEach((function(e){i.classList.add(e)})),a&&(i.innerHTML=a),i})),r(this,"shrinkDynamicTemplateVarsData",(function(e){var t=[];return e.length&&e.forEach((function(e){var r={id:e.id,value:e.value};t.push(r)})),t})),r(this,"getEmailMessage",(function(e){var r="";if(e.email_message)r=e.email_message;else{var a=t.bswpDynamicTemplVarsData.find((function(e){return"bswp_email_message"===e.id}));a&&(r=a.replace)}return r})),r(this,"filterBlockAttributes",(function(e){var t={};for(var r in e)i.includes(r)||(t[r]=e[r]);return t})),r(this,"prepareCustomTemplateVars",(function(e){var r=t.filterBlockAttributes(e);return t.bswpCustomDynamicTemplVars.forEach((function(e){r[e.id]||(r[e.id]=e.replace)})),r})),r(this,"successContinueAction",(function(e){e.target.closest(".wp-block-cgb-block-ea-better-sharing").querySelector(".bswp-email-success-modal").classList.add("bswp-email-success-modal-hidden")})),r(this,"parseSuccessScreenContent",(function(e,r,a){var i=e.querySelector(".success-screen");if(i){var n=i.innerHTML,s=t.parseContent(n,r);i.innerHTML=s;var l=e.querySelector(".bswp-success-message-hidden").innerHTML,o=new RegExp("{{\\s?emails_count\\s?}}","g"),c=a||"",m=l.replaceAll(o,c);e.querySelector(".bswp-success-message").innerHTML=m;var u=i.querySelector(".success-continue");u&&u.addEventListener("click",(function(e){t.successContinueAction(e)}))}})),this.emailData=[],this.email_sender={},this.replyto={},this.loggedinUser={},this.emailsLimit="",this.emailModalTriggers=document.querySelectorAll(".trigger-email-btn"),this.emailModalTriggers.length&&this.toggleEmailModal(),this.emailInput=document.querySelector(".bswp-share-email-input"),this.emailInputs=document.querySelectorAll(".bswp-share-email-input"),this.customMsgInputs=document.querySelectorAll(".bswp-email-custom-message textarea"),this.submit=document.querySelectorAll(".bswp-submit"),this.addressBookBtns=document.querySelectorAll(".add-from-address-book-init"),this.apiRoot=bswpApiSettings.api_root,this.bswp_version=bswpApiSettings.bswp_version,this.initBswpDynamicTemplateVars(),this.initLoggedinUser(),this.emailInput&&(this.initEmailData(),this.events()),this.initEmailPreviewShadowDOM()}var a,n;return a=e,(n=[{key:"toggleEmailModal",value:function(){this.emailModalTriggers.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.closest(".email");t.querySelector(".bswp-email-modal").classList.remove("bswp-email-modal-hidden"),t.querySelector("#bswp-close-email-modal").addEventListener("click",(function(e){e.preventDefault(),t.querySelector(".bswp-email-modal").classList.add("bswp-email-modal-hidden")}))}))}))}},{key:"events",value:function(){var e=this;this.submit.length&&this.submit.forEach((function(t){t.addEventListener("click",(function(t){e.submitMail(t)}))})),this.addressBookBtns.length&&this.addressBookBtns.forEach((function(t){t.addEventListener("click",(function(t){e.initAddressBook(t)}))})),this.customMsgInputs.length&&this.customMsgInputs.forEach((function(t){t.addEventListener("input",(function(t){e.previewCustomMessage(t)}))})),this.emailInputs.length&&this.emailInputs.forEach((function(t){t.addEventListener("input",(function(t){if(!t.target.value.trim()){var r=t.target.closest(".email"),a="there";if(e.bswpDynamicTemplVars.length){var i=e.bswpDynamicTemplVars.find((function(e){return"bswp_greeting"===e.id}));i&&(a=i.base)}e.updatePreviewContent(r,"greeting",a)}}))}))}},{key:"initEmailData",value:function(){if(this.email_sender.first_name="",this.email_sender.last_name="",this.email_sender.email="",this.replyto.first_name="",this.replyto.last_name="",this.replyto.email="",document.querySelector(".bswp-emails-limit")&&(this.emailsLimit=document.querySelector(".bswp-emails-limit").value),this.loggedinUser.first_name&&(this.email_sender.first_name=this.loggedinUser.first_name,this.replyto.first_name=this.loggedinUser.first_name),this.loggedinUser.last_name&&(this.email_sender.last_name=this.loggedinUser.last_name,this.replyto.last_name=this.loggedinUser.last_name),this.loggedinUser.email&&(this.email_sender.email=this.loggedinUser.email,this.replyto.email=this.loggedinUser.email),!this.email_sender.first_name&&this.bswpDynamicTemplVars.length){var e=this.bswpDynamicTemplVars.find((function(e){return"bswp_sender_first_name"===e.id}));e&&e.base.trim()&&(this.email_sender.first_name=e.base)}}},{key:"initAddressBook",value:function(e){var t=this;if(e.preventDefault(),"undefined"==typeof cloudsponge||!cloudsponge)return!1;var r=e.target.closest(".email"),a=r.querySelector(".bswp-share-email-input");a.classList.add("cloudsponge-contacts");var i="",n="";cloudsponge.init({displaySelectAllNone:!1,bswp_version:this.bswp_version,selectionLimit:function(){return t.emailsLimit},selectionLimitMessage:"You may only select "+this.emailsLimit+" contacts.",afterSubmitContacts:function(e,s,l){t.loggedinUser.email||(t.email_sender.email=l.email[0].address,t.email_sender.first_name=l.first_name,t.email_sender.last_name=l.last_name,n=l.first_name),t.loggedinUser.first_name||(t.email_sender.first_name=l.first_name,n=l.first_name),t.replyto.email=l.email[0].address,t.replyto.first_name=l.first_name,t.replyto.last_name=l.last_name,a.value+=e.map((function(e){e.email[0].address;var r=e.email[0].address;t.emailData.some((function(t){return t.recipient_email===r&&t.recipient_first_name===e.first_name&&t.recipient_last_name===e.last_name}))||t.emailData.push({recipient_email:r,recipient_first_name:e.first_name,recipient_last_name:e.last_name}),e.first_name&&!i&&(i=e.first_name)}));var o=a.value.split(/[\s,]+/);o=o.reduce((function(e,t,r,a){return-1==e.indexOf(t)&&e.push(t),e}),[]),a.value=o.join(", "),a.classList.remove("cloudsponge-contacts"),i&&t.updatePreviewContent(r,"greeting",i),n&&t.updatePreviewContent(r,"sender",n)},afterInit:function(){cloudsponge.launch()}})}},{key:"submitMail",value:function(e){var t=this;e.preventDefault();var r=e.target.closest(".wp-block-cgb-block-ea-better-sharing"),a=r.querySelector(".bswp-share-email-content"),i=r.querySelector(".bswp-share-email-input"),n=r.querySelector(".bswp-ref-link"),s=n?n.value:"",l=r.querySelector(".email-template").value,o=r.querySelector("#coreblock-email-sent-msg");if(this.validateEmailForm(r)){var c=JSON.parse(r.dataset.blockAttr),m=c.id,u=this.handleEmails(i.value),p="";a&&(p=a.value);var b=this.getEmailMessage(c),f=this.bswpDynamicTemplVarsData.find((function(e){return"bswp_greeting"===e.id})),d=this.prepareCustomTemplateVars(c),g={sender:this.email_sender,emails:u,message:p,template:l,referral_link:s,email_message:b,greeting:f?f.replace:"",ui_template:m?m.trim():"",custom_dynamic_templ_vars:d,replyto:this.replyto},h=new XMLHttpRequest;h.open("POST","".concat(this.apiRoot,"bswp/v1/bswp_email"),!0),h.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),h.setRequestHeader("X-WP-Nonce",bswpApiSettings.nonce),h.onreadystatechange=function(){if(4===h.readyState){var n=JSON.parse(h.responseText);if(e.target.innerHTML="Send",e.target.disabled=!1,e.target.style="inherit",n.mail.result){i.value="",t.updatePreviewContent(r),a&&(a.value=""),t.parseSuccessScreenContent(r,c,n.mail.success_emails);var s=r.querySelector(".bswp-email-modal:not(bswp-email-modal-hidden)");s&&s.classList.add("bswp-email-modal-hidden"),r.querySelector(".bswp-email-success-modal").classList.remove("bswp-email-success-modal-hidden"),t.initEmailData()}else t.messageDisplay(n.mail.message,"coreblock-error-msg",o)}},h.send(JSON.stringify(g)),e.target.innerHTML="Sending ...",e.target.disabled=!0,e.target.style.backgroundColor="#525354",e.target.style.color="#fff"}}}])&&t(a.prototype,n),Object.defineProperty(a,"prototype",{writable:!1}),e}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,m(a.key),a)}}function o(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,r){return(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){var t=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===s(t)?t:String(t)}var u=o((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"events",(function(){t.buttons.length&&t.buttons.forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.closest(".referral-link"),r=t.querySelector("input"),a=t.querySelector(".referral-btn-copy"),i=a.dataset.textDone,n=a.dataset.textDefault;if("text"===r.type){var s=r;s.select(),s.setSelectionRange(0,99999),document.execCommand("copy"),a.children[1].innerHTML=i,setTimeout((function(){a.children[1].innerHTML=n}),1500)}else if("hidden"===r.type){var l=navigator.clipboard,o=t.querySelector(".copy-info");l.writeText(r.value),o.innerHTML=i,setTimeout((function(){o.innerHTML=n}),1500)}}))}))})),c(this,"init",(function(){var e=document.getElementsByTagName("meta");if(e.length)for(var r=function(r){String(e[r].getAttribute("itemprop")).includes("bswp_")&&"bswp_referral_link"===e[r].getAttribute("itemprop")&&(t.urlToShareInput.length&&t.urlToShareInput.forEach((function(t){var a=t.closest(".wp-block-cgb-block-ea-better-sharing");JSON.parse(a.dataset.blockAttr).referral_link||(t.value=e[r].getAttribute("content"))})),t.refLinkValueHolder.length&&t.refLinkValueHolder.forEach((function(t){var a=t.closest(".wp-block-cgb-block-ea-better-sharing");JSON.parse(a.dataset.blockAttr).referral_link||(t.value=e[r].getAttribute("content"))})))},a=0;a<e.length;a++)r(a)})),this.buttons=document.querySelectorAll(".referral-btn-copy"),this.urlToShareInput=document.querySelectorAll(".wp-block-cgb-block-ea-better-sharing .referral-link input"),this.refLinkValueHolder=document.querySelectorAll(".wp-block-cgb-block-ea-better-sharing .bswp-ref-link"),this.events(),this.init()}));function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function b(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,g(a.key),a)}}function f(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==p(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}var h=f((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"init",(function(){t.setDynamicTemplVars(),t.notEmpty(t.bswpDynamicTemplVars)&&t.useDynamicTemplateVars()})),d(this,"notEmpty",(function(e){return Object.keys(e).length>0})),d(this,"setDynamicTemplVars",(function(){var e=document.getElementsByTagName("meta");if(e.length)for(var r=0;r<e.length;r++)if(String(e[r].getAttribute("itemprop")).includes("bswp_")&&t.expectedDynamicTemplVars.includes(e[r].getAttribute("itemprop"))){var a={id:e[r].getAttribute("itemprop"),value:e[r].getAttribute("content")};t.bswpDynamicTemplVars[e[r].getAttribute("itemprop")]=a}})),d(this,"useDynamicTemplateVars",(function(){for(var e in t.socialShare)t.socialShare[e].length&&t.injectDynamicTemplateVars(t.socialShare[e],e)})),d(this,"injectDynamicTemplateVars",(function(e,r){switch(r){case"x":if(t.bswpDynamicTemplVars.bswp_referral_link||t.bswpDynamicTemplVars.bswp_x_message){var a="?url=",i="&text=";e.forEach((function(e){var r=e.closest(".wp-block-cgb-block-ea-better-sharing"),n=JSON.parse(r.dataset.blockAttr);if(!n.referral_link||!n.x_message){var s=e.href,l=!1,o=s.split(a),c=o[1].split(i);!n.referral_link&&t.bswpDynamicTemplVars.bswp_referral_link&&t.bswpDynamicTemplVars.bswp_referral_link.value.trim()&&(c[0]=t.bswpDynamicTemplVars.bswp_referral_link.value.trim(),l=!0),!n.x_message&&t.bswpDynamicTemplVars.bswp_x_message&&t.bswpDynamicTemplVars.bswp_x_message.value.trim()&&(c[1]=t.bswpDynamicTemplVars.bswp_x_message.value.trim(),l=!0),l&&(s="".concat(o[0]).concat(a).concat(c[0]).concat(i).concat(c[1]),e.setAttribute("href",s))}}))}break;case"fb":if(t.bswpDynamicTemplVars.bswp_referral_link&&t.bswpDynamicTemplVars.bswp_referral_link.value.trim()){var n="?&u=",s=t.bswpDynamicTemplVars.bswp_referral_link.value.trim(),l=e[0].href,o=l.split(n);l="".concat(o[0]).concat(n).concat(s),e.forEach((function(e){var t=e.closest(".wp-block-cgb-block-ea-better-sharing");JSON.parse(t.dataset.blockAttr).referral_link||e.setAttribute("href",l)}))}}})),document.querySelectorAll(".social-links").length&&(this.socialShare={x:document.querySelectorAll(".bswp-twitter-btn"),fb:document.querySelectorAll(".bswp-facebook-btn")},this.expectedDynamicTemplVars=["bswp_referral_link","bswp_x_message"],this.bswpDynamicTemplVars={},this.init())}));window.addEventListener("DOMContentLoaded",(function(){new n,new u,new h}))})();